<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.5, maximum-scale=3.0">
    <title>Vittime del Conflitto a Gaza - Analisi Demografica</title>
    <meta name="author" content="Giovan Battista Vitrano per OpenDataSicilia.it">
    <meta http-equiv="content-language" content="IT">
    <meta name="robots" content="index,follow">
    <meta name="creation_Date" content="23/09/2025">
    <link rel="shortcut icon" href="favicon.ico"/> 
    <link rel="icon" href="favicon.png" type="image/png"/> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
	
    <!-- Meta tags per social sharing pen Graph Protocol -->
    <meta property="og:url" content="https://palermohub.github.io/Palestine/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="In memoria delle vite perdute. Questa analisi presenta i dati demografici delle 60,199 vittime documentate nel conflitto (23/09/2025), con l'obiettivo di fornire una comprensione rispettosa della tragedia umana. by @opendatasicilia">
    <meta property="og:description" content="Palermo Hub - Contenitore di mappe su Palermo realizzato da OpenDataSicilia.it">
    <meta property="og:image" content="https://palermohub.github.io/Palestine/img/social_card.jpg">
	<!-- twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="palermohub.opendatasicilia.it">
    <meta property="twitter:url" content="https://palermohub.github.io/Palestine/">
    <meta name="twitter:title" content="In memoria delle vite perdute. Questa analisi presenta i dati demografici delle 60,199 vittime documentate nel conflitto (23/09/2025), con l'obiettivo di fornire una comprensione rispettosa della tragedia umana. by @opendatasicilia">
    <meta name="twitter:description" content="Palermo Hub - Contenitore di mappe su Palermo realizzato da OpenDataSicilia.it">
    <meta name="twitter:image" content="https://palermohub.github.io/Palestine/img/social_card.jpg">
	
	
    <style>
        /* Reset e base styles */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            margin: 0;
            padding: clamp(10px, 3vw, 20px);
            background: #f8f9fa;
            min-height: 100vh;
            color: #2c3e50;
            line-height: 1.6;
            font-size: clamp(14px, 2.5vw, 16px);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: clamp(5px, 1vw, 10px);
            padding: clamp(20px, 4vw, 40px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-top: 4px solid #34495e;
        }
        
        .header {
            text-align: center;
            margin-bottom: clamp(30px, 5vw, 50px);
            padding-bottom: clamp(20px, 3vw, 30px);
            border-bottom: 2px solid #ecf0f1;
        }
        
        .title {
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            line-height: 1.2;
            hyphens: auto;
            word-break: break-word;
        }
        
        .subtitle {
            font-size: clamp(1rem, 3vw, 1.2rem);
            color: #7f8c8d;
            margin-bottom: 20px;
            font-style: italic;
            padding: 0 10px;
        }
        
        .memorial-note {
            background: #34495e;
            color: white;
            padding: clamp(15px, 3vw, 20px);
            border-radius: 8px;
            margin-bottom: clamp(30px, 4vw, 40px);
            text-align: center;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            line-height: 1.6;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(220px, 100%), 1fr));
            gap: clamp(15px, 3vw, 25px);
            margin-bottom: clamp(30px, 5vw, 50px);
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: clamp(20px, 4vw, 30px);
            border-radius: 8px;
            text-align: center;
            border: 1px solid #dee2e6;
            border-left: 5px solid;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .stat-card.male { border-left-color: #5d6d7e; }
        .stat-card.female { border-left-color: #85929e; }
        .stat-card.total { border-left-color: #2c3e50; }
        .stat-card.minors { 
            border-left-color: #e74c3c;
            background: #fdedec;
        }
        
        .stat-number {
            font-size: clamp(1.8rem, 6vw, 2.5rem);
            font-weight: bold;
            margin-bottom: 10px;
            font-family: 'Arial', sans-serif;
            word-break: break-all;
        }
        
        .stat-number.male { color: #5d6d7e; }
        .stat-number.female { color: #85929e; }
        .stat-number.total { color: #2c3e50; }
        .stat-number.minors { color: #e74c3c; }
        
        .stat-label {
            font-size: clamp(0.8rem, 2vw, 1rem);
            color: #566573;
            font-weight: 600;
            line-height: 1.4;
        }
        
        .minors-highlight {
            background: linear-gradient(135deg, #fdedec 0%, #fadbd8 100%);
            border: 2px solid #e74c3c;
            padding: clamp(25px, 4vw, 35px);
            border-radius: 10px;
            margin: clamp(30px, 5vw, 50px) 0;
            text-align: center;
        }
        
        .minors-highlight h2 {
            font-size: clamp(1.3rem, 4vw, 1.8rem);
            margin-bottom: 20px;
            color: #c0392b;
            font-weight: bold;
            hyphens: auto;
        }
        
        .minors-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(180px, 100%), 1fr));
            gap: clamp(15px, 3vw, 20px);
            margin-top: clamp(20px, 3vw, 30px);
        }
        
        .minors-stat {
            background: rgba(255,255,255,0.8);
            padding: clamp(15px, 3vw, 20px);
            border-radius: 8px;
            border: 1px solid #e6b3b3;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .minors-stat h3 {
            font-size: clamp(1.2rem, 4vw, 1.6rem);
            margin-bottom: 5px;
            color: #e74c3c;
            font-family: 'Arial', sans-serif;
            word-break: break-all;
        }
        
        .minors-stat p {
            font-size: clamp(0.8rem, 2vw, 1rem);
            color: #922b21;
            line-height: 1.4;
            margin: 0;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: clamp(30px, 5vw, 40px);
            margin: clamp(30px, 5vw, 50px) 0;
        }
        
        .chart-wrapper {
            background: #f8f9fa;
            border-radius: 10px;
            padding: clamp(20px, 3vw, 30px);
            border: 1px solid #dee2e6;
            overflow: hidden;
        }
        
        .chart-title {
            text-align: center;
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: clamp(20px, 3vw, 25px);
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
            hyphens: auto;
            line-height: 1.3;
        }
        
        .chart-container {
            position: relative;
            height: clamp(350px, 50vh, 500px);
            width: 100%;
            max-width: 100%;
        }
        
        .chart-container canvas {
            max-width: 100% !important;
            height: auto !important;
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: clamp(20px, 4vw, 40px);
            margin: clamp(30px, 4vw, 40px) 0;
            background: #f8f9fa;
            padding: clamp(15px, 3vw, 20px);
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            font-size: clamp(0.8rem, 2vw, 1rem);
            color: #2c3e50;
            white-space: nowrap;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            flex-shrink: 0;
        }
        
        .legend-color.male { background-color: #5d6d7e; }
        .legend-color.female { background-color: #85929e; }
        
        .analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(min(350px, 100%), 1fr));
            gap: clamp(20px, 3vw, 30px);
            margin-top: clamp(30px, 5vw, 50px);
        }
        
        .analysis-card {
            background: #f8f9fa;
            padding: clamp(20px, 3vw, 30px);
            border-radius: 10px;
            border-left: 4px solid #5d6d7e;
            border: 1px solid #dee2e6;
        }
        
        .analysis-card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            font-weight: bold;
            hyphens: auto;
        }
        
        .analysis-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .analysis-list li {
            margin-bottom: 15px;
            padding: clamp(12px, 2vw, 15px);
            background: white;
            border-radius: 5px;
            color: #34495e;
            line-height: 1.6;
            border-left: 3px solid #bdc3c7;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
        }
        
        .analysis-list li:last-child {
            margin-bottom: 0;
        }
        
        .source {
            text-align: center;
            margin-top: clamp(30px, 5vw, 50px);
            padding: clamp(20px, 4vw, 30px);
            background: #2c3e50;
            color: white;
            border-radius: 10px;
        }
        
        .source p {
            margin: 10px 0;
            line-height: 1.6;
            font-size: clamp(0.8rem, 2vw, 1rem);
        }
        
        .source .credit {
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            font-weight: bold;
            color: #ecf0f1;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #566573;
        }

        /* Styling per i link */
        a {
            color: #ffffff;
            text-decoration: none;
            word-break: break-word;
            hyphens: auto;
        }

        a:hover {
            color: #ff9900;
            text-decoration: underline;
        }

        /* Touch-friendly interactions */
        .stat-card,
        .minors-stat,
        .analysis-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .stat-card:hover,
        .minors-stat:hover,
        .analysis-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        /* Responsive breakpoints */
        
        /* Small mobile devices (320px - 480px) */
        @media (max-width: 480px) {
            body {
                padding: 8px;
                font-size: 14px;
            }
            
            .container {
                padding: 15px;
                border-radius: 5px;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .minors-stats {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .legend {
                flex-direction: column;
                gap: 15px;
            }
            
            .analysis {
                grid-template-columns: 1fr;
            }

            .title {
                font-size: 1.6rem;
                word-break: break-word;
            }
        }
        
        /* Large mobile devices (481px - 768px) */
        @media (min-width: 481px) and (max-width: 768px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .minors-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .chart-container {
                height: 400px;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
        }
        
        /* Tablets (769px - 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .minors-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .analysis {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Small desktops (1025px - 1200px) */
        @media (min-width: 1025px) and (max-width: 1200px) {
            .charts-container {
                grid-template-columns: 1fr 1fr;
            }
            
            .analysis {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Large desktops (1201px+) */
        @media (min-width: 1201px) {
            .charts-container {
                grid-template-columns: 1fr 1fr;
            }
            
            .analysis {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        /* Landscape orientation adjustments */
        @media (max-height: 600px) and (orientation: landscape) {
            .chart-container {
                height: 250px;
            }
            
            .title {
                font-size: 2rem;
                margin-bottom: 10px;
            }
            
            .header {
                margin-bottom: 30px;
                padding-bottom: 20px;
            }
        }
        
        /* High DPI displays */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .container {
                box-shadow: 0 8px 25px rgba(0,0,0,0.12);
            }
        }
        
        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Print styles */
        @media print {
            body {
                background: white;
                font-size: 12pt;
            }
            
            .container {
                box-shadow: none;
                border: 1px solid #000;
                padding: 20px;
            }
            
            .chart-container {
                height: 400px;
                page-break-inside: avoid;
            }
            
            .analysis-card,
            .minors-highlight {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Vittime del Conflitto a Gaza</h1>
            <p class="subtitle">Analisi demografica delle persone decedute per età e sesso</p>
        </div>
        
        <div class="memorial-note">
            In memoria delle vite perdute. Questa analisi presenta i dati demografici delle 60,199 vittime 
            documentate nel conflitto (23/09/2025), con l'obiettivo di fornire una comprensione rispettosa della tragedia umana.
        </div>
        
        <div class="stats-container">
            <div class="stat-card male">
                <div class="stat-number male">40,990</div>
                <div class="stat-label">Uomini deceduti (68.1%)</div>
            </div>
            <div class="stat-card female">
                <div class="stat-number female">19,209</div>
                <div class="stat-label">Donne decedute (31.9%)</div>
            </div>
            <div class="stat-card minors">
                <div class="stat-number minors">18,457</div>
                <div class="stat-label">Minori deceduti 0-17 anni (30.7%)</div>
            </div>
            <div class="stat-card total">
                <div class="stat-number total">60,199</div>
                <div class="stat-label">Totale vittime documentate</div>
            </div>
        </div>
        
        <div class="minors-highlight">
            <h2>Vittime minorenni (0-17 anni)</h2>
            <p style="font-size: clamp(0.9rem, 2.5vw, 1.1rem); margin-bottom: 10px; color: #922b21;">
                <strong>18,457 bambini e adolescenti hanno perso la vita, rappresentando il 30.7% del totale</strong>
            </p>
            <div class="minors-stats">
                <div class="minors-stat">
                    <h3>10,656</h3>
                    <p>Bambini e ragazzi maschi</p>
                </div>
                <div class="minors-stat">
                    <h3>7,801</h3>
                    <p>Bambine e ragazze femmine</p>
                </div>
                <div class="minors-stat">
                    <h3>14,824</h3>
                    <p>Bambini 0-14 anni (24.6%)</p>
                </div>
                <div class="minors-stat">
                    <h3>3,633</h3>
                    <p>Adolescenti 15-17 anni</p>
                </div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color male"></div>
                <span>Uomini e ragazzi (sinistra)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color female"></div>
                <span>Donne e ragazze (destra)</span>
            </div>
        </div>
        
        <div class="charts-container">
            <div class="chart-wrapper">
                <div class="chart-title">Distribuzione per Fasce d'età - Tutte le Vittime</div>
                <div class="chart-container">
                    <canvas id="pyramidChart"></canvas>
                </div>
            </div>
            
            <div class="chart-wrapper">
                <div class="chart-title">Focus sulle Vittime Minorenni (0-17 anni)</div>
                <div class="chart-container">
                    <canvas id="minorsChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="analysis">
            <div class="analysis-card">
                <h3>Profilo Demografico delle Vittime</h3>
                <ul class="analysis-list">
                    <li><strong>Popolazione prevalentemente giovane:</strong> Il 61% delle vittime aveva meno di 40 anni</li>
                    <li><strong>Fascia più colpita:</strong> 30-34 anni con 7,193 decessi</li>
                    <li><strong>Impatto sui minori:</strong> Quasi un terzo delle vittime (30.7%) erano minorenni</li>
                    <li><strong>Prima infanzia:</strong> 4,744 bambini tra 0-4 anni hanno perso la vita</li>
                </ul>
            </div>
            
            <div class="analysis-card" style="border-left-color: #85929e;">
                <h3>Distribuzione per Genere</h3>
                <ul class="analysis-list">
                    <li><strong>Prevalenza maschile:</strong> 68.1% uomini e ragazzi vs 31.9% donne e ragazze</li>
                    <li><strong>Tra i minori:</strong> 57.7% bambini maschi vs 42.3% bambine femmine</li>
                    <li><strong>Maggiore disparità:</strong> Nelle fasce adulte 20-50 anni</li>
                    <li><strong>Distribuzione più equilibrata:</strong> Negli anziani over 75 anni</li>
                </ul>
            </div>
            
            <div class="analysis-card" style="border-left-color: #e74c3c;">
                <h3>Impatto sui Bambini per Fascia d'età</h3>
                <ul class="analysis-list">
                    <li><strong>Prima infanzia (0-4 anni):</strong> 4,744 vittime - bambini in età prescolare</li>
                    <li><strong>Età scolare (5-9 anni):</strong> 4,822 vittime - bambini delle elementari</li>
                    <li><strong>Preadolescenza (10-14 anni):</strong> 5,258 vittime - ragazzi delle medie</li>
                    <li><strong>Adolescenza (15-17 anni):</strong> 3,633 vittime - giovani liceali</li>
                </ul>
            </div>
        </div>
        
        <div class="source">
            <p><strong>Fonte dati:</strong> <a href="https://data.techforpalestine.org/" title="Palestine Datasets" target="_blank">data.techforpalestine.org</a> - Dataset "<a href="https://data.techforpalestine.org/docs/killed-in-gaza/" title="killed-in-gaza.csv" target="_blank">killed-in-gaza.csv</a>"</p>
            <p>Analisi basata su 60,199 record documentati e verificati (100% di completezza del dataset)</p>
            <p>I dati riflettono le perdite umane documentate nel conflitto e sono presentati con il massimo rispetto per le vittime e le loro famiglie.</p>
            <p class="credit">Rielaborazione by <a href="http://opendatasicilia.it/" title="@opendatasicilia" target="_blank">@opendatasicilia</a></p>
        </div>
    </div>

    <script>
        // Dati delle vittime per fasce d'età - INVERTITI (base = età più bassa)
        const ageGroups = ['90+', '85-89', '80-84', '75-79', '70-74', '65-69', '60-64', '55-59', '50-54', '45-49', '40-44', '35-39', '30-34', '25-29', '20-24', '15-19', '10-14', '5-9', '0-4'];
        const maleData = [29, 74, 143, 293, 541, 711, 965, 1197, 1423, 1824, 2529, 3833, 5109, 4984, 4730, 4453, 3104, 2545, 1985];
        const femaleData = [57, 70, 140, 186, 300, 384, 536, 638, 657, 775, 890, 1170, 1619, 1704, 1579, 1832, 2154, 2277, 1791];

        // Dati specifici per i minori (0-17 anni) - INVERTITI
        const minorAgeGroups = ['15-17', '10-14', '5-9', '0-4'];
        const minorMaleData = [2968, 3104, 2545, 1985];
        const minorFemaleData = [1221, 2154, 2277, 1791];

        // Trova il valore massimo per bilanciare l'asse
        const maxValue = Math.max(...maleData, ...femaleData);
        const minorMaxValue = Math.max(...minorMaleData, ...minorFemaleData);

        // Funzione per determinare se siamo su mobile
        function isMobile() {
            return window.innerWidth <= 768;
        }

        // Configurazione responsive per tooltips
        const getResponsiveTooltipConfig = (isMinorChart = false) => {
            const total = isMinorChart ? 18457 : 60199;
            const mobile = isMobile();
            
            return {
                enabled: true,
                external: null,
                position: 'nearest',
                animation: {
                    duration: mobile ? 100 : 200,
                    easing: 'easeInOutCubic'
                },
                backgroundColor: 'rgba(44, 62, 80, 0.95)',
                titleColor: '#ecf0f1',
                bodyColor: '#bdc3c7',
                footerColor: '#95a5a6',
                borderColor: '#34495e',
                borderWidth: mobile ? 1 : 2,
                cornerRadius: mobile ? 6 : 8,
                displayColors: true,
                padding: mobile ? 10 : 15,
                titleFont: {
                    size: mobile ? 12 : 14,
                    weight: 'bold',
                    family: 'Arial, sans-serif'
                },
                bodyFont: {
                    size: mobile ? 11 : 13,
                    family: 'Arial, sans-serif'
                },
                footerFont: {
                    size: mobile ? 10 : 12,
                    family: 'Arial, sans-serif',
                    style: 'italic'
                },
                multiKeyBackground: '#2c3e50',
                usePointStyle: true,
                boxPadding: mobile ? 4 : 6,
                callbacks: {
                    title: function(context) {
                        return mobile ? `Età: ${context[0].label}` : `Fascia d'età: ${context[0].label}`;
                    },
                    beforeBody: function(context) {
                        return mobile ? [] : ['————————————————————'];
                    },
                    label: function(context) {
                        const value = Math.abs(context.raw);
                        const percentage = ((value / total) * 100).toFixed(1);
                        const gender = context.datasetIndex === 0 ? (mobile ? 'M' : 'Uomini/Ragazzi') : (mobile ? 'F' : 'Donne/Ragazze');
                        return mobile ? 
                            `${gender}: ${value.toLocaleString('it-IT')} (${percentage}%)` :
                            `${gender}: ${value.toLocaleString('it-IT')} vittime (${percentage}%)`;
                    },
                    afterBody: function(context) {
                        if (context.length >= 2 && !mobile) {
                            const maleValue = Math.abs(context[0].raw);
                            const femaleValue = context[1].raw;
                            const ageTotal = maleValue + femaleValue;
                            const agePercentage = ((ageTotal / total) * 100).toFixed(1);
                            
                            return [
                                '',
                                `Totale fascia: ${ageTotal.toLocaleString('it-IT')} vittime`,
                                `Percentuale sul totale: ${agePercentage}%`
                            ];
                        }
                        return [];
                    },
                    footer: function(context) {
                        return mobile ? '' : (isMinorChart ? 'Dati: vittime minorenni (0-17 anni)' : 'Dati: tutte le vittime documentate');
                    }
                }
            };
        };

        // Configurazione responsive per l'interazione
        const getResponsiveInteractionConfig = () => {
            const mobile = isMobile();
            return {
                mode: mobile ? 'nearest' : 'point',
                intersect: false,
                includeInvisible: false,
                axis: 'xy'
            };
        };

        // Configurazione responsive per le opzioni comuni
        const getResponsiveCommonOptions = (isMinorChart = false) => {
            const maxVal = isMinorChart ? minorMaxValue : maxValue;
            const mobile = isMobile();
            
            return {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                devicePixelRatio: window.devicePixelRatio || 1,
                interaction: getResponsiveInteractionConfig(),
                onHover: (event, activeElements, chart) => {
                    if (event.native && event.native.target) {
                        event.native.target.style.cursor = activeElements.length > 0 ? 'pointer' : 'default';
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: getResponsiveTooltipConfig(isMinorChart)
                },
                scales: {
                    x: {
                        stacked: true,
                        min: -maxVal * 1.1,
                        max: maxVal * 1.1,
                        grid: {
                            color: 'rgba(108, 117, 125, 0.2)',
                            drawBorder: false,
                            drawOnChartArea: true,
                            lineWidth: mobile ? 0.5 : 1
                        },
                        ticks: {
                            callback: function(value) {
                                const absValue = Math.abs(value);
                                if (mobile && absValue >= 1000) {
                                    return (absValue / 1000).toFixed(0) + 'k';
                                }
                                return absValue.toLocaleString('it-IT');
                            },
                            color: '#566573',
                            font: {
                                size: mobile ? 9 : 11
                            },
                            maxTicksLimit: mobile ? 6 : 8
                        }
                    },
                    y: {
                        stacked: true,
                        grid: {
                            display: false
                        },
                        ticks: {
                            color: '#2c3e50',
                            font: {
                                size: mobile ? 10 : 12,
                                weight: 'bold'
                            }
                        }
                    }
                },
                layout: {
                    padding: mobile ? 5 : 10
                },
                categoryPercentage: 0.8,
                barPercentage: mobile ? 0.8 : 0.7,
                animation: {
                    duration: mobile ? 500 : 1000,
                    easing: 'easeInOutCubic'
                },
                hoverBorderWidth: mobile ? 1 : 2,
                hoverBackgroundColor: function(context) {
                    const color = context.datasetIndex === 0 ? '#5d6d7e' : '#85929e';
                    return color;
                },
                hoverBorderColor: '#2c3e50'
            };
        };

        // Inizializzazione dei grafici
        let pyramidChart, minorsChart;

        function initCharts() {
            // Distruggi i grafici esistenti se presenti
            if (pyramidChart) {
                pyramidChart.destroy();
            }
            if (minorsChart) {
                minorsChart.destroy();
            }

            // Grafico principale - piramide dell'età
            const ctx1 = document.getElementById('pyramidChart').getContext('2d');
            pyramidChart = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: ageGroups,
                    datasets: [
                        {
                            label: 'Uomini',
                            data: maleData.map(value => -value),
                            backgroundColor: '#5d6d7e',
                            borderColor: '#5d6d7e',
                            borderWidth: 0,
                            borderRadius: 0,
                            hoverBackgroundColor: '#4a5a6a',
                            hoverBorderColor: '#2c3e50',
                            hoverBorderWidth: isMobile() ? 1 : 2
                        },
                        {
                            label: 'Donne',
                            data: femaleData,
                            backgroundColor: '#85929e',
                            borderColor: '#85929e',
                            borderWidth: 0,
                            borderRadius: 0,
                            hoverBackgroundColor: '#6b7b8a',
                            hoverBorderColor: '#2c3e50',
                            hoverBorderWidth: isMobile() ? 1 : 2
                        }
                    ]
                },
                options: getResponsiveCommonOptions(false)
            });

            // Grafico minori - piramide dell'età
            const ctx2 = document.getElementById('minorsChart').getContext('2d');
            minorsChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: minorAgeGroups,
                    datasets: [
                        {
                            label: 'Bambini e ragazzi',
                            data: minorMaleData.map(value => -value),
                            backgroundColor: '#5d6d7e',
                            borderColor: '#5d6d7e',
                            borderWidth: 0,
                            borderRadius: 0,
                            hoverBackgroundColor: '#4a5a6a',
                            hoverBorderColor: '#2c3e50',
                            hoverBorderWidth: isMobile() ? 1 : 2
                        },
                        {
                            label: 'Bambine e ragazze',
                            data: minorFemaleData,
                            backgroundColor: '#85929e',
                            borderColor: '#85929e',
                            borderWidth: 0,
                            borderRadius: 0,
                            hoverBackgroundColor: '#6b7b8a',
                            hoverBorderColor: '#2c3e50',
                            hoverBorderWidth: isMobile() ? 1 : 2
                        }
                    ]
                },
                options: getResponsiveCommonOptions(true)
            });
        }

        // Gestione del ridimensionamento della finestra
        let resizeTimeout;
        function handleResize() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                initCharts();
            }, 250);
        }

        // Event listeners
        window.addEventListener('resize', handleResize);
        window.addEventListener('orientationchange', () => {
            setTimeout(handleResize, 100);
        });

        // Inizializzazione
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(initCharts, 100);
        });
    </script>
</body>
</html>